---
title: "Vulnerability Data Analysis"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
bibliography: ../../PRP_Climate_Change.bib
suppress-bibliography: true
csl: ../../chicago-fullnote-bibliography-with-ibid.csl
---


In this exercise, we will explore SDG's 13.1.1 indicator, [XXX], associated with target 13.1, [XXX]. The indicator's associated data is from the Emergency Events Database (EM-DAT), managed by the Centre for Research on the Epidemiology of Disasters (CRED) [-@CRED2021].

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      warning = FALSE, 
                      fig.height = 5, 
                      fig.pos = "H", 
                      out.extra = '',
                      tidy.opts=list(width.cutoff=50), 
                      tidy=TRUE)

```

## Load libraries

First, we need to load the following libraries:

```{r libraries, message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
library(janitor)
```

Below is the session information, which include the version of R, loaded packages, and platforms used. This helpful to know when conducting replications of data and analysis

```{r}
sessionInfo()
```

## Download the dataset

You can access the full database [here](https://public.emdat.be/) by submitting a query for the data you need. You will need to register with the database first before you can submit a query. For the purpose of this exercise, we will provide you with the full dataset that starts from 1970. This dataset is as of March 22, 2021.


## Import dataset

Using the package `readxl` we can import the dataset that's in Excel format. If you preview the raw file in Excel, you will find that the first six rows are used as description of the dataset, therefore we need to make sure that R does not read rows that are not part of the dataset. The function `read_excel` provides a convenient option called `skip`, which tells R how many rows to skip before reading the dataset. In this case, we need to skip six rows.

```{r}
em_dat <- readxl::read_excel("emdat_public_2021_03_22_query_uid-2i1xa8_raw.xlsx",
                     skip = 6)
```


## Clean dataset

Using the `janitor` package, we can use the function `clean_names` to create consistent-looking variable names.

```{r}
em_dat <- janitor::clean_names(em_dat)
```

Instead of recreating the object `em_dat` again, we can combine the previous two functions using the 'pipe' operator, `%>%`, which is loaded with the `tidyverse` package. This operator uses the previous output as the new input of the subsequent function.

```{r} 
em_dat <- readxl::read_excel("emdat_public_2021_03_22_query_uid-2i1xa8_raw.xlsx", skip = 6) %>%
          janitor::clean_names() 
```

In the above code chunk, we did the following:

1. Imported the dataset using `read_excel` function.
2. Took that dataset and cleaned all the variables' names using the `clean_names` function.
3. Called the output of the previous two processes `em_dat`.

The `pipe` operator is a powerful function that can reduce the amount of code you need to write.

<!--## References-->

